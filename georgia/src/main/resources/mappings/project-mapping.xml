<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="projectDAO">

	<resultMap id="projectResult" type="project">
		<id property="p_id" column="p_id" />
		<result property="p_name" column="p_name" />
		<result property="p_content" column="p_content" />
		<result property="p_start" column="p_start" />
		<result property="p_end" column="p_end" />
		<result property="p_state" column="p_state" />
	</resultMap>

	<select id="listSelectProject" resultMap="projectResult">
		SELECT *
		FROM project
		ORDER BY p_id
		LIMIT #{page}, 20
	</select>

	<select id="oneSelectProject" resultType="project">
		SELECT *
		FROM project
		WHERE p_id = #{p_id}
	</select>

	<insert id="createProject" parameterType="project">
		INSERT INTO project(p_id, p_name, p_content, p_start, p_end, p_state)
		VALUES((SELECT IFNULL(MAX(p_id)+1,1) FROM project ALIAS_FOR_SUBQUERY), #{p_name}, #{p_content}, #{p_start}, #{p_end}, #{p_state})
	</insert>
	
	<update id="updateProject" parameterType="project">
		UPDATE project
		SET p_name = #{p_name}, p_content= #{p_content}, p_start=  #{p_start}, p_end = #{p_end}, p_state = #{p_state}
		WHERE p_id = #{p_id} 
	</update>
	
</mapper>